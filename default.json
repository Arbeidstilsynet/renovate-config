{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:best-practices",
    ":automergeMinor",
    ":automergeLinters",
    ":automergeTesters",
    ":automergeTypes",
    ":automergeDigest",
    "mergeConfidence:all-badges"
  ],
  "minimumReleaseAge": "96 hours",
  "semanticCommits": "enabled",
  "lockFileMaintenance": { "enabled": true },
  "packageRules": [
    {
      "matchUpdateTypes": ["pinDigest"],
      "automerge": true,
      "description": "Automerge pinDigest PRs (e.g., GitHub Actions, Docker digests)"
    },
    {
      "matchPackageNames": [
        "coverlet.collector",
        "Microsoft.NET.Test.Sdk",
        "NSubstitute",
        "Bogus",
        "Shouldly",
        "Testcontainers",
        "Testcontainers.*",
        "WireMock.*",
        "Verify",
        "Verify.*",
        "TngTech.ArchUnitNET",
        "TngTech.ArchUnitNET.*",
        "xunit",
        "xunit.*"
      ],
      "matchManagers": ["nuget"],
      "matchUpdateTypes": ["minor", "patch"],
      "automerge": true,
      "groupName": ".NET Testing",
      "description": "Automerge .NET testing packages"
    },
    {
      "matchPackageNames": ["typescript"],
      "automerge": true
    },
    {
      "matchPackageNames": [
        "aws-sdk*",
        "AWSSDK*",
        "@aws-sdk/**",
        "boto3",
        "botocore"
      ],
      "groupName": "AWS SDK",
      "description": "Group AWS SDK packages across languages and only update monthly to reduce noise",
      "schedule": ["every 4th week on Saturday and Sunday"]
    },
    {
      "matchPackageNames": ["Amazon.Lambda*"],
      "matchManagers": ["nuget"],
      "groupName": ".NET namespace Amazon.Lambda"
    },
    {
      "matchPackageNames": ["Arbeidstilsynet.*"],
      "matchManagers": ["nuget"],
      "groupName": "Arbeidstilsynet namespace"
    },
    {
      "matchPackageNames": ["@arbeidstilsynet/*"],
      "matchManagers": ["npm"],
      "groupName": "@arbeidstilsynet namespace"
    },
    {
      "matchPackageNames": ["AT.*", "Arkivering.Events*"],
      "matchManagers": ["nuget"],
      "groupName": ".NET namespace AT",
      "description": ".NET packages in the AT namespace or that depend on AT.Common.Core"
    },
    {
      "matchPackageNames": ["FluentAssertions"],
      "matchManagers": ["nuget"],
      "allowedVersions": "<8",
      "description": "Prevent updates to FluentAssertions v8 or higher because of licensing changes"
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "managerFilePatterns": ["/^Dockerfile$/"],
      "matchStrings": [
        "#\\s*renovate:\\s*datasource=(?<datasource>.*?) depName=(?<depName>.*?)( versioning=(?<versioning>.*?))?\\sENV .*?_VERSION=\"(?<currentValue>.*)\"\\s"
      ],
      "versioningTemplate": "{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}"
    }
  ]
}
