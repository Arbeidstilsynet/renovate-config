{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:best-practices",
    ":automergeMinor",
    ":automergeLinters",
    ":automergeTesters",
    ":automergeTypes",
    ":automergeDigest",
    "mergeConfidence:all-badges",
    "customManagers:dockerfileVersions"
  ],
  "minimumReleaseAge": "96 hours",
  "semanticCommits": "enabled",
  "lockFileMaintenance": { "enabled": true },
  "packageRules": [
    {
      "matchUpdateTypes": ["pinDigest"],
      "automerge": true,
      "description": "Automerge pinDigest PRs (e.g., GitHub Actions, Docker digests) because it's always safe"
    },
    {
      "matchPackageNames": [
        "coverlet.collector",
        "Microsoft.NET.Test.Sdk",
        "NSubstitute",
        "Bogus",
        "Shouldly",
        "Testcontainers",
        "Testcontainers.*",
        "WireMock.*",
        "Verify",
        "Verify.*",
        "TngTech.ArchUnitNET",
        "TngTech.ArchUnitNET.*",
        "xunit",
        "xunit.*"
      ],
      "matchManagers": ["nuget"],
      "matchUpdateTypes": ["minor", "patch"],
      "automerge": true,
      "groupName": ".NET Testing",
      "description": "Automerge .NET testing packages because errors will be caught by CI"
    },
    {
      "matchPackageNames": ["typescript", "@typescript/native-preview"],
      "matchManagers": ["npm"],
      "automerge": true,
      "description": "Automerge TS because it's a devDependency, doesn't follow semver, and errors will be caught by CI"
    },
    {
      "matchPackageNames": [
        "aws-sdk*",
        "AWSSDK*",
        "@aws-sdk/**",
        "boto3",
        "botocore"
      ],
      "groupName": "AWS SDK",
      "schedule": ["every 4th week on Saturday and Sunday"],
      "description": "Group AWS SDK packages across languages and only update monthly to reduce noise"
    },
    {
      "matchPackageNames": ["Arbeidstilsynet.*"],
      "matchManagers": ["nuget"],
      "groupName": ".NET Arbeidstilsynet namespace",
      "minimumReleaseAge": null,
      "description": "Group internal .NET packages and disable minimum release age"
    },
    {
      "matchPackageNames": ["@arbeidstilsynet/*"],
      "matchManagers": ["npm"],
      "groupName": "NPM @arbeidstilsynet scope",
      "description": "Group internal NPM packages but keep minimum release age for PNPM compatibility"
    },
    {
      "matchDatasources": ["docker"],
      "matchSourceUrls": ["/^https:\\/\\/github.com\\/Arbeidstilsynet\\/.*$/"],
      "minimumReleaseAge": null,
      "description": "Disable minimum release age for internal Docker images"
    },
    {
      "matchPackageNames": [
        "Arbeidstilsynet.Receiver",
        "ghcr.io/arbeidstilsynet/receiver",
        "/^.*-docker\\.pkg\\.dev\\/nais-management-.*\\/meldinger\\/receiver$/"
      ],
      "matchManagers": ["kubernetes", "docker", "docker-compose", "nuget"],
      "groupName": "Arbeidstilsynet.Receiver group",
      "description": "Group Receiver image and .NET client together"
    }
  ]
}
